# Command injection and SQL injection vulnerability scanner
## Why
Security testing is very different from other kind of testing since the goal is not detecting software defects (i.e., unexpected behaviors) but revealing flaws in the security mechanisms of the application under test. This scanner has the task of detecting possible vulnerabilities of the application under test.
## Command injection
Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system (OS) via a vulnerable application. These attacks are possible when an application did not sanitize user inputs and passes this unsafe inputs (from forms, cookies, HTTP headers etc.) to a system shell. In this attack, this dangerous commands are usually executed with the privileges of the vulnerable application.
### What the scanner does
The scanner check if the desired url is command injectable with the parameters provided using different techinques like create a file with garbage contents and check if the created file is inside the folder of the vulnerable code, running ```ls``` commands with all variants to see if the provided file appears or running ```uname``` command to check the SO.<br>
After that it will inject all comand payloads provided via file.
## Union-based SQL Injections
This kind of attacks uses the UNION keyword, concatenated with the vulnerable query, to retrieve data from other tables within the database. This attack can execute one or more additional SELECT queries.
For this type of attack there are two requirements to be satisfied:<br>
<ul>
<li> each SELECT queries must return the same number of columns; </li>
<li> data types of each column in the SELECT queries must be similar.</li>
</ul>

### What the scanner does
To retrieve the correct number of columns in the query the scanner uses the ORDER BY technique that consist to injecting a series of ORDER BY clauses and incrementing the specified column index until an error occurs.<br>
Then it append one or more SELECT queries with the right number of columns and perform an UNION-based SQL injections attack.
This scanner uses the right number of columns to retrieve DBMS informations like the version. After that the payload from the supplied file is injected for each parameter and the result is written to an output file.

## Execution
This section will explain how to run the scanner for both injections.
### Arguments
<b>--t</b>, A target host (e.g., http://localhost);<br>
<b>--u</b>, Single or a list of URLs to scan;<br>
<b>--m</b>, A list of methods for each URL;<br>
<b>--p</b>, A list of parameters for each URL;<br>
<b>--i</b>, The kind of injection to perform;<br>
<b>--f</b>, File containing payload to inject. (Must be inside the script folder)

### Run examples
Command injection via GET request with one parameter
```console
umaru@andrea:~$ python scanner.py --t http://localhost:4000 --u ping.php --m GET --p host --i cmd --f cmd_payload.txt
```
SQL injection via POST request with two parameters
```console
umaru@andrea:~$ python scanner.py --t http://localhost:4000 --u login.php --m POST --p user:pass --i sql --f sql_payload.txt
```
SQL injection via GET request with one parameter
```console
umaru@andrea:~$ python scanner.py --t http://localhost:4000 --u search_by_price.php --m GET --p max --i sql --f sql_payload.txt
```
